{
  "id": "cb931656",
  "title": "Verify hornet setup on Ubuntu droplet (manual)",
  "tags": [
    "infra",
    "ubuntu",
    "ci"
  ],
  "status": "done",
  "created_at": "2026-02-17T02:30:39.055Z"
}

## Result
Verified on DigitalOcean Ubuntu 24.04 droplet (4GB RAM, 2 vCPU).

### Bugs found and fixed
1. **`setup.sh` — shared repo permissions**: ran `git config` as `hornet_agent` on admin's repo → agent can't access admin home. Fix: run as `$ADMIN_USER` instead.
2. **`setup.sh` — harden-permissions path**: called source copy (`$REPO_DIR/bin/harden-permissions.sh`) which agent can't access. Fix: use deployed copy (`$HORNET_HOME/runtime/bin/`).
3. **`setup.sh` — CWD inheritance**: `sudo -u hornet_agent` inherits root's CWD, causing `find`/`git` failures. Fix: `cd /tmp` at top of script.
4. **`harden-permissions.sh` — sessions dir**: `find` on non-existent sessions dir fails under `set -e`. Fix: wrap in `if [ -d ... ]` guard.
5. **`hornet-safe-bash` — `grep -P`**: Perl regex not reliably available on Ubuntu. Fix: all patterns converted to `grep -E`.

### Verification results
- ✅ `setup.sh` completes cleanly (user, Node, pi, firewall, hidepid, deploy, harden)
- ✅ All 5 test suites pass (tool-guard, bridge security, extension scanner, safe-bash, log redaction)
- ✅ Varlock validates env schema
- ✅ `start.sh` boots pi agent (fails at API auth with dummy keys — expected)
- ✅ Firewall active with all rules
- ✅ Process isolation working

### PR
https://github.com/modem-dev/hornet/pull/10
